name: Debug SSH Connection

on:
  push:
    branches:
      - deploy_test

jobs:
  ssh-debug:
    runs-on: ubuntu-latest

    steps:
      - name: Setup SSH and test connection
        run: |
          echo "üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –∫–ª—é—á–∞..."
          mkdir -p ~/.ssh
          echo "${{ secrets.SSH_PRIVATE_KEY }}" > ~/.ssh/id_ed25519
          chmod 600 ~/.ssh/id_ed25519

          echo "üì• –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞ –≤ known_hosts..."
          ssh-keyscan -H "${{ secrets.REMOTE_HOST }}" >> ~/.ssh/known_hosts

          echo "üöÄ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ ${{ secrets.REMOTE_USER }}@${{ secrets.REMOTE_HOST }}"
          ssh -o StrictHostKeyChecking=no -i ~/.ssh/id_ed25519 \
              ${{ secrets.REMOTE_USER }}@${{ secrets.REMOTE_HOST }} \
              "echo '‚úÖ SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'"
              